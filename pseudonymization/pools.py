# pseudonymization/pools.py
"""
ë°ì´í„°í’€ ê´€ë¦¬ ëª¨ë“ˆ (ìˆ˜ì •ëœ ë²„ì „)
- í™•ì¥ëœ ì œì™¸ ë‹¨ì–´ ë¦¬ìŠ¤íŠ¸
- ì •ë¦¬ëœ ì‹¤ëª… ëª©ë¡
- ë” ì—„ê²©í•œ í•„í„°ë§
"""

import os
import csv
from typing import Set, List, Dict, Any

# ë³µí•© ì„±ì”¨ (2ê¸€ì)
COMPOUND_SURNAMES = {
    'ë‚¨ê¶', 'ë…ê³ ', 'ë™ë°©', 'ë§ì ˆ', 'ì‚¬ê³µ', 'ì„œë¬¸', 'ì„ ìš°', 'ì†Œë´‰', 'ì–´ê¸ˆ',
    'ì¥ê³¡', 'ì œê°ˆ', 'í™©ë³´', 'ì‚¬ë§ˆ', 'ì—¬ë‚¨', 'ì² ìˆ˜', 'ë³µì•¼', 'ê°•ì „'
}

# ë‹¨ì¼ ì„±ì”¨ (1ê¸€ì)
SINGLE_SURNAMES = {
    'ê¹€', 'ì´', 'ë°•', 'ìµœ', 'ì •', 'ê°•', 'ì¡°', 'ìœ¤', 'ì¥', 'ì„', 'í•œ', 'ì˜¤', 'ì„œ', 'ì‹ ',
    'ê¶Œ', 'í™©', 'ì•ˆ', 'ì†¡', 'ë¥˜', 'ì „', 'í™', 'ê³ ', 'ë¬¸', 'ì–‘', 'ì†', 'ë°°', 'ì¡°', 'ë°±',
    'í—ˆ', 'ìœ ', 'ë‚¨', 'ì‹¬', 'ë…¸', 'ì •', 'í•˜', 'ê³½', 'ì„±', 'ì°¨', 'ì£¼', 'ìš°', 'êµ¬', 'ì‹ ',
    'ì„', 'ë‚˜', 'ì „', 'ë¯¼', 'ìœ ', 'ì§„', 'ì§€', 'ì—„', 'ì±„', 'ì›', 'ì²œ', 'ë°©', 'ê³µ', 'ê°•',
    'í˜„', 'í•¨', 'ë³€', 'ì—¼', 'ì–‘', 'ë³€', 'ì—¬', 'ì¶”', 'ë…¸', 'ë„', 'ì†Œ', 'ì„', 'ì„ ', 'ì„¤',
    'ë§ˆ', 'ê¸¸', 'ì—°', 'ìœ„', 'í‘œ', 'ëª…', 'ê¸°', 'ë°˜', 'ì™•', 'ê¸ˆ', 'ì˜¥', 'ìœ¡', 'ì¸', 'ë§¹',
    'ì œ', 'ëª¨', 'ì¥', 'ë‚¨', 'íƒ', 'êµ­', 'ì—¬', 'ì§„', 'ì–´', 'ì€', 'í¸', 'ê³¡', 'ë³€', 'ìŠ¹',
    'ê°€', 'ê²½', 'ê°„', 'ê°ˆ', 'ê°•', 'ê²¬', 'ê²½', 'ê³¡', 'ê³½', 'êµ', 'êµ¬', 'êµ­', 'êµ°', 'ê¶',
    'ê¶Œ', 'ê·¼', 'ê¸ˆ', 'ê¸°', 'ê¸¸', 'ê¹€', 'ë‚˜', 'ë‚¨', 'ë‚´', 'ë…¸', 'ë‡Œ', 'ë‹¨', 'ë‹¹', 'ëŒ€',
    'ë„', 'ë…', 'ëˆ', 'ë‘', 'ë¥˜', 'ë§ˆ', 'ë§Œ', 'ëª…', 'ëª¨', 'ëª©', 'ë¬¸', 'ë¯¸', 'ë¯¼', 'ë°•',
    'ë°˜', 'ë°©', 'ë°°', 'ë°±', 'ë³€', 'ë³´', 'ë³µ', 'ë´‰', 'ë¶€', 'ë¹„', 'ë¹ˆ', 'ì‚¬', 'ì‚°', 'ì‚¼',
    'ìƒ', 'ì„œ', 'ì„', 'ì„ ', 'ì„¤', 'ì„­', 'ì„±', 'ì†Œ', 'ì†', 'ì†¡', 'ìˆ˜', 'ìˆœ', 'ìŠ¹', 'ì‹œ',
    'ì‹ ', 'ì‹¬', 'ì•ˆ', 'ì• ', 'ì–‘', 'ì–´', 'ì—„', 'ì—¬', 'ì—°', 'ì—¼', 'ì˜', 'ì˜ˆ', 'ì˜¤', 'ì˜¥',
    'ì˜¨', 'ì™•', 'ìš”', 'ìš©', 'ìš°', 'ìš´', 'ì›', 'ìœ„', 'ìœ ', 'ìœ¤', 'ì€', 'ì´', 'ì¸', 'ì„',
    'ì', 'ì¥', 'ì „', 'ì •', 'ì œ', 'ì¡°', 'ì¢…', 'ì£¼', 'ì§€', 'ì§„', 'ì°¨', 'ì°½', 'ì±„', 'ì²œ',
    'ìµœ', 'ì¶”', 'íƒ', 'íƒœ', 'íŒ', 'í¸', 'í‰', 'í•˜', 'í•™', 'í•œ', 'í•¨', 'í•´', 'í—ˆ', 'í˜„',
    'í˜•', 'í˜¸', 'í™', 'í™”', 'í™˜', 'í™©', 'í›„', 'í¥'
}

# ëŒ€í­ í™•ì¥ëœ ì œì™¸ ë‹¨ì–´ ë¦¬ìŠ¤íŠ¸
NAME_EXCLUDE_WORDS = {
    # ë¬¸ë²• ìš”ì†Œë“¤
    'ì´ë¦„ì€', 'ì´ë¦„ì´', 'ì´ë¦„ì„', 'ì´ë¦„ê³¼', 'ì´ë¦„ë§Œ', 'ì´ë¦„ë„', 'ì´ë¦„ì—', 'ì´ë¦„ìœ¼ë¡œ',
    'ì´ê³ ', 'ì´ë©°', 'ì´ë‹¤', 'ì…ë‹ˆë‹¤', 'í–ˆìŠµë‹ˆë‹¤', 'ìˆìŠµë‹ˆë‹¤', 'ì—†ìŠµë‹ˆë‹¤', 'ë©ë‹ˆë‹¤',
    'í–ˆì–´ìš”', 'í•´ìš”', 'ê°€ìš”', 'ì™€ìš”', 'ë‚˜ìš”', 'ì´ì—ìš”', 'ì˜ˆìš”', 'ì´ì•¼', 'ì•¼',
    'ì—ì„œ', 'ì—ê²Œ', 'ìœ¼ë¡œ', 'ë¡œ', 'ì™€', 'ê³¼', 'ì´', 'ê°€', 'ì„', 'ë¥¼', 'ì€', 'ëŠ”',
    'ì˜', 'ë„', 'ë§Œ', 'ë¶€í„°', 'ê¹Œì§€', 'ë§ˆì €', 'ì¡°ì°¨', 'ë°–ì—', 'ë¿', 'ì²˜ëŸ¼', 'ê°™ì´',
    
    # ì§€ì—­ëª…ë“¤
    'ì„œìš¸', 'ë¶€ì‚°', 'ëŒ€êµ¬', 'ì¸ì²œ', 'ê´‘ì£¼', 'ëŒ€ì „', 'ìš¸ì‚°', 'ì„¸ì¢…', 'ê²½ê¸°', 'ê°•ì›',
    'ì¶©ë¶', 'ì¶©ë‚¨', 'ì „ë¶', 'ì „ë‚¨', 'ê²½ë¶', 'ê²½ë‚¨', 'ì œì£¼',
    'ê°•ë‚¨', 'ê°•ë¶', 'ê°•ì„œ', 'ê°•ë™', 'ì„œì´ˆ', 'ì†¡íŒŒ', 'ë§ˆí¬', 'ìš©ì‚°', 'ì¢…ë¡œ', 'ì¤‘êµ¬',
    'ë™êµ¬', 'ì„œêµ¬', 'ë‚¨êµ¬', 'ë¶êµ¬', 'ì˜ë“±í¬', 'ê´€ì•…', 'ì„±ë¶', 'ë™ëŒ€ë¬¸', 'ë…¸ì›',
    'ì€í‰', 'ì„œëŒ€ë¬¸', 'ê¸ˆì²œ', 'êµ¬ë¡œ', 'ë„ë´‰', 'ë™ì‘', 'ì„±ë™', 'ì¤‘ë‘', 'ì–‘ì²œ',
    'ìˆ˜ì›', 'ì„±ë‚¨', 'ì•ˆì–‘', 'ë¶€ì²œ', 'ì•ˆì‚°', 'ìš©ì¸', 'í‰íƒ', 'ì‹œí¥', 'ê¹€í¬', 'ê´‘ëª…',
    'êµ°í¬', 'í•˜ë‚¨', 'ì˜¤ì‚°', 'ì´ì²œ', 'ì•ˆì„±', 'ì˜ì™•', 'ì–‘í‰', 'ì—¬ì£¼', 'ê³¼ì²œ',
    
    # ì¼ë°˜ ëª…ì‚¬ë“¤
    'ì‚¬ëŒ', 'í•™ìƒ', 'ì„ ìƒ', 'ì„ ìƒë‹˜', 'ì˜ì‚¬', 'ê°„í˜¸ì‚¬', 'êµì‚¬', 'íšŒì‚¬ì›', 'ì§ì¥ì¸',
    'íšŒì‚¬', 'í•™êµ', 'ë³‘ì›', 'ì€í–‰', 'ìš°ì²´êµ­', 'ê²½ì°°ì„œ', 'ì†Œë°©ì„œ', 'ì‹œì²­', 'êµ¬ì²­',
    'ìŒì‹', 'ìš”ë¦¬', 'ë°¥', 'ë¬¼', 'ì°¨', 'ì»¤í”¼', 'ì±…', 'ì‹ ë¬¸', 'ì»´í“¨í„°', 'í•¸ë“œí°',
    'ìë™ì°¨', 'ë²„ìŠ¤', 'ì§€í•˜ì² ', 'ê¸°ì°¨', 'ë¹„í–‰ê¸°', 'ì§‘', 'ì•„íŒŒíŠ¸', 'ë¹Œë”©', 'ê±´ë¬¼',
    'ë‚˜ë¬´', 'ê½ƒ', 'í’€', 'ë°”ë‹¤', 'ê°•', 'ì‚°', 'í•˜ëŠ˜', 'êµ¬ë¦„', 'ë³„', 'ë‹¬', 'í•´',
    'ë¶ˆ', 'ë°”ëŒ', 'ëˆˆ', 'ë¹„', 'ë²ˆê°œ', 'ì²œë‘¥', 'ì§€ì§„', 'íƒœí’',
    
    # ì‹œê°„ ê´€ë ¨
    'ì˜¤ëŠ˜', 'ë‚´ì¼', 'ì–´ì œ', 'ëª¨ë ˆ', 'ê¸€í”¼', 'ì´ë²ˆ', 'ë‹¤ìŒ', 'ì§€ë‚œ', 'ì˜¬í•´', 'ë‚´ë…„',
    'ì‘ë…„', 'ì´ë‹¬', 'ë‹¤ìŒë‹¬', 'ì§€ë‚œë‹¬', 'ì´ì£¼', 'ë‹¤ìŒì£¼', 'ì§€ë‚œì£¼',
    'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼', 'ì¼ìš”ì¼',
    'ì•„ì¹¨', 'ì ì‹¬', 'ì €ë…', 'ë°¤', 'ìƒˆë²½', 'ì˜¤ì „', 'ì˜¤í›„', 'ì •ì˜¤', 'ìì •',
    
    # ê°ì •/í˜•ìš©ì‚¬
    'ì¢‹ì€', 'ë‚˜ìœ', 'ì˜ˆìœ', 'ëª»ìƒê¸´', 'í°', 'ì‘ì€', 'ë†’ì€', 'ë‚®ì€', 'ë¹ ë¥¸', 'ëŠë¦°',
    'ìƒˆë¡œìš´', 'ì˜¤ë˜ëœ', 'ê¹¨ë—í•œ', 'ë”ëŸ¬ìš´', 'ë°ì€', 'ì–´ë‘ìš´', 'ë”°ëœ»í•œ', 'ì°¨ê°€ìš´',
    'ëœ¨ê±°ìš´', 'ì‹œì›í•œ', 'ë‹¬ì½¤í•œ', 'ì“´', 'ì§ ', 'ë§¤ìš´', 'ì‹ ', 'ê³ ì†Œí•œ',
    
    # ë™ì‘/ë™ì‚¬
    'ê°€ë‹¤', 'ì˜¤ë‹¤', 'ë³´ë‹¤', 'ë“£ë‹¤', 'ë§í•˜ë‹¤', 'ë¨¹ë‹¤', 'ë§ˆì‹œë‹¤', 'ìë‹¤', 'ì¼ì–´ë‚˜ë‹¤',
    'ì•‰ë‹¤', 'ì„œë‹¤', 'ê±·ë‹¤', 'ë›°ë‹¤', 'ì½ë‹¤', 'ì“°ë‹¤', 'ê·¸ë¦¬ë‹¤', 'ë…¸ë˜í•˜ë‹¤', 'ì¶¤ì¶”ë‹¤',
    'ì›ƒë‹¤', 'ìš¸ë‹¤', 'ìƒê°í•˜ë‹¤', 'ê³µë¶€í•˜ë‹¤', 'ì¼í•˜ë‹¤', 'ë†€ë‹¤', 'ì‰¬ë‹¤',
    'ë§Œë“¤ë‹¤', 'ë¶€ìˆ˜ë‹¤', 'ì—´ë‹¤', 'ë‹«ë‹¤', 'ì¼œë‹¤', 'ë„ë‹¤', 'ì°¾ë‹¤', 'ìƒë‹¤', 'ì£¼ë‹¤', 'ë°›ë‹¤',
    
    # ì§ˆë¬¸ì‚¬/ì§€ì‹œì‚¬
    'ëˆ„êµ¬', 'ë¬´ì—‡', 'ì–¸ì œ', 'ì–´ë””', 'ì–´ë–»ê²Œ', 'ì™œ', 'ì–´ëŠ', 'ëª‡', 'ì–¼ë§ˆ',
    'ì´ê²ƒ', 'ê·¸ê²ƒ', 'ì €ê²ƒ', 'ì—¬ê¸°', 'ê±°ê¸°', 'ì €ê¸°', 'ì´ëŸ°', 'ê·¸ëŸ°', 'ì €ëŸ°',
    'ì´ë ‡ê²Œ', 'ê·¸ë ‡ê²Œ', 'ì €ë ‡ê²Œ', 'ê°™ì€', 'ë‹¤ë¥¸', 'ì–´ë–¤', 'ëª¨ë“ ', 'ê°ê°',
    
    # ìˆ˜ëŸ‰/ë‹¨ìœ„
    'í•˜ë‚˜', 'ë‘˜', 'ì…‹', 'ë„·', 'ë‹¤ì„¯', 'ì—¬ì„¯', 'ì¼ê³±', 'ì—¬ëŸ', 'ì•„í™‰', 'ì—´',
    'ê°œ', 'ëª…', 'ë§ˆë¦¬', 'ëŒ€', 'ê¶Œ', 'ì¥', 'ë³‘', 'ì”', 'ê·¸ë¦‡', 'ì ‘ì‹œ',
    'í‚¬ë¡œ', 'ê·¸ë¨', 'ë¦¬í„°', 'ë¯¸í„°', 'ì„¼í‹°', 'ì¸ì¹˜', 'ì‹œê°„', 'ë¶„', 'ì´ˆ',
    
    # ê°€ì¡± ê´€ê³„
    'ì•„ë²„ì§€', 'ì–´ë¨¸ë‹ˆ', 'ì•„ë¹ ', 'ì—„ë§ˆ', 'í• ì•„ë²„ì§€', 'í• ë¨¸ë‹ˆ', 'í˜•', 'ëˆ„ë‚˜', 'ì–¸ë‹ˆ', 'ì˜¤ë¹ ',
    'ë™ìƒ', 'ë‚¨ë™ìƒ', 'ì—¬ë™ìƒ', 'ì•„ë“¤', 'ë”¸', 'ë‚¨í¸', 'ì•„ë‚´', 'ë¶€ì¸', 'ì‹ ë‘', 'ì‹ ë¶€',
    'ì‚¼ì´Œ', 'ì´ëª¨', 'ê³ ëª¨', 'ì™¸ì‚¼ì´Œ', 'í°ì•„ë²„ì§€', 'ì‘ì€ì•„ë²„ì§€', 'í°ì–´ë¨¸ë‹ˆ', 'ì‘ì€ì–´ë¨¸ë‹ˆ',
    
    # ì§ì—…
    'íšŒì‚¬ì›', 'ê³µë¬´ì›', 'ì„ ìƒë‹˜', 'ì˜ì‚¬', 'ê°„í˜¸ì‚¬', 'ë³€í˜¸ì‚¬', 'íŒì‚¬', 'ê²€ì‚¬', 'ê²½ì°°',
    'ì†Œë°©ê´€', 'êµ°ì¸', 'ê¸°ì', 'ì‘ê°€', 'í™”ê°€', 'ê°€ìˆ˜', 'ë°°ìš°', 'ìš”ë¦¬ì‚¬', 'ìš´ì „ì‚¬',
    'ë†ë¶€', 'ì–´ë¶€', 'ëª©ìˆ˜', 'ì „ê¸°ê¸°ì‚¬', 'ì—”ì§€ë‹ˆì–´', 'í”„ë¡œê·¸ë˜ë¨¸', 'ë””ìì´ë„ˆ',
    
    # í•™êµ ê´€ë ¨
    'ìœ ì¹˜ì›', 'ì´ˆë“±í•™êµ', 'ì¤‘í•™êµ', 'ê³ ë“±í•™êµ', 'ëŒ€í•™êµ', 'ëŒ€í•™ì›', 'í•™ê³¼', 'ì „ê³µ',
    'ìˆ˜ì—…', 'ì‹œí—˜', 'ìˆ™ì œ', 'ë°©í•™', 'í•™ê¸°', 'ì„±ì ', 'ì¡¸ì—…', 'ì…í•™', 'ì „í•™',
    
    # ìƒ‰ê¹”
    'ë¹¨ê°„', 'íŒŒë€', 'ë…¸ë€', 'ì´ˆë¡', 'ê²€ì€', 'í•˜ì–€', 'íšŒìƒ‰', 'ë¶„í™', 'ë³´ë¼', 'ì£¼í™©',
    'ê°ˆìƒ‰', 'ê¸ˆìƒ‰', 'ì€ìƒ‰', 'ë¬´ì§€ê°œ', 'íˆ¬ëª…í•œ',
    
    # ìŒì‹
    'ë°¥', 'ë¹µ', 'êµ­ìˆ˜', 'ë¼ë©´', 'ìš°ë™', 'ëƒ‰ë©´', 'ê¹€ì¹˜', 'ë¶ˆê³ ê¸°', 'ê°ˆë¹„', 'ì‚¼ê²¹ì‚´',
    'ì¹˜í‚¨', 'í”¼ì', 'í–„ë²„ê±°', 'ìƒëŸ¬ë“œ', 'ê³¼ì¼', 'ì‚¬ê³¼', 'ë°°', 'ë°”ë‚˜ë‚˜', 'í¬ë„',
    'ë”¸ê¸°', 'ìˆ˜ë°•', 'ì°¸ì™¸', 'ë³µìˆ­ì•„', 'ê·¤', 'ì˜¤ë Œì§€',
    
    # ë¬¸ë²•ì ìœ¼ë¡œ ì´ë¦„ì´ ë  ìˆ˜ ì—†ëŠ” íŒ¨í„´ë“¤
    'ê·¸ëŸ°ë°', 'í•˜ì§€ë§Œ', 'ê·¸ë˜ì„œ', 'ë”°ë¼ì„œ', 'ê·¸ëŸ¬ë‚˜', 'ë˜í•œ', 'ê·¸ë¦¬ê³ ', 'ë˜ëŠ”',
    'ë§Œì•½', 'ë§Œì¼', 'í˜¹ì‹œ', 'ì•„ë§ˆ', 'ì •ë§', 'ì§„ì§œ', 'ê±°ì§“', 'ê°€ì§œ',
    'ì•„ì§', 'ë²Œì¨', 'ì´ë¯¸', 'ê³§', 'ì¦‰ì‹œ', 'ë°”ë¡œ', 'ì²œì²œíˆ', 'ë¹¨ë¦¬', 'ë§¤ìš°', 'ì¡°ê¸ˆ',
    
    # ì¸í„°ë„·/í†µì‹  ê´€ë ¨
    'ì¸í„°ë„·', 'ì´ë©”ì¼', 'ì „í™”', 'ë¬¸ì', 'ì¹´í†¡', 'ë©”ì‹ ì €', 'ë¸”ë¡œê·¸', 'í™ˆí˜ì´ì§€',
    'ì›¹ì‚¬ì´íŠ¸', 'ìœ íŠœë¸Œ', 'í˜ì´ìŠ¤ë¶', 'ì¸ìŠ¤íƒ€ê·¸ë¨', 'íŠ¸ìœ„í„°',
    
    # ê¸°íƒ€ ì œì™¸í•  ë‹¨ì–´ë“¤
    'ì•ˆë…•', 'ê³ ë§ˆì›Œ', 'ë¯¸ì•ˆ', 'ì£„ì†¡', 'ë°˜ê°€ì›Œ', 'ì˜ê°€', 'ì•ˆë…•íˆ', 'ìˆ˜ê³ ',
    'í™”ì´íŒ…', 'íŒŒì´íŒ…', 'ê´œì°®ì•„', 'ëì–´', 'ì•Œì•˜ì–´', 'ëª°ë¼', 'ê¸€ì„',
    'ì •ë§ë¡œ', 'ì‚¬ì‹¤', 'ê±°ì§“ë§', 'ë†ë‹´', 'ì§„ì‹¬', 'ì¥ë‚œ', 'ì¬ë¯¸', 'ì‹œê°„',
    'ê±°ì£¼í•˜ì‹œ', 'ë¶„ì´ì‹œ', 'ìœ¼ë¡œ', 'ë©”ì¼', 'ë³´ë‚´ë“œë ¸', 'ë³´ë‚´ë“œë¦°', 'ë³´ë‚´ì„œ',
    'ì—°ë½ì²˜', 'ì—°ë½', 'ë¬¸ì˜ì‚¬í•­', 'ë¬¸ì˜', 'ì§ˆë¬¸', 'ë‹µë³€', 'í™•ì¸', 'ì˜ˆì•½',
    'ê³ ê°ë‹˜', 'ì†ë‹˜', 'ì„ ìƒë‹˜', 'ë‹˜', 'ì”¨', 'ì–‘', 'êµ°'
}

class DataPools:
    """ë°ì´í„°í’€ í´ë˜ìŠ¤"""
    
    def __init__(self):
        self._initialized = False
        self.real_names = set()  # CSVì—ì„œ ë¡œë“œëœ ì‹¤ëª…ë“¤
        self.real_addresses = set()
        self.road_names = set()
        self.companies = set()
        
        # ì§€ì—­ ë°ì´í„°
        self.provinces = {'ì„œìš¸', 'ë¶€ì‚°', 'ëŒ€êµ¬', 'ì¸ì²œ', 'ê´‘ì£¼', 'ëŒ€ì „', 'ìš¸ì‚°', 'ì„¸ì¢…'}
        self.cities = {
            'ì„œìš¸ì‹œ', 'ë¶€ì‚°ì‹œ', 'ëŒ€êµ¬ì‹œ', 'ì¸ì²œì‹œ', 'ê´‘ì£¼ì‹œ', 'ëŒ€ì „ì‹œ', 'ìš¸ì‚°ì‹œ', 'ì„¸ì¢…ì‹œ',
            'ìˆ˜ì›ì‹œ', 'ì„±ë‚¨ì‹œ', 'ì•ˆì–‘ì‹œ', 'ë¶€ì²œì‹œ', 'ì•ˆì‚°ì‹œ', 'ìš©ì¸ì‹œ', 'í‰íƒì‹œ', 'ì‹œí¥ì‹œ'
        }
        self.districts = {
            'ê°•ë‚¨êµ¬', 'ê°•ë¶êµ¬', 'ê°•ì„œêµ¬', 'ê°•ë™êµ¬', 'ì„œì´ˆêµ¬', 'ì†¡íŒŒêµ¬', 'ë§ˆí¬êµ¬', 'ìš©ì‚°êµ¬',
            'ì¢…ë¡œêµ¬', 'ì¤‘êµ¬', 'ë™êµ¬', 'ì„œêµ¬', 'ë‚¨êµ¬', 'ë¶êµ¬', 'ì˜ë“±í¬êµ¬', 'ê´€ì•…êµ¬',
            'ì„±ë¶êµ¬', 'ë™ëŒ€ë¬¸êµ¬', 'ë…¸ì›êµ¬', 'ì€í‰êµ¬', 'ì„œëŒ€ë¬¸êµ¬', 'ê¸ˆì²œêµ¬', 'êµ¬ë¡œêµ¬',
            'ë„ë´‰êµ¬', 'ë™ì‘êµ¬', 'ì„±ë™êµ¬', 'ì¤‘ë‘êµ¬', 'ì–‘ì²œêµ¬', 'í•´ìš´ëŒ€êµ¬', 'ë¶€ì‚°ì§„êµ¬',
            'ë™ë˜êµ¬', 'ë‚¨êµ¬', 'ì¤‘êµ¬', 'ìˆ˜ì„±êµ¬', 'ë‹¬ì„œêµ¬', 'ë‹¬ì„±êµ°'
        }
        
        # ê°€ëª… í’€ (ì¹˜í™˜ìš©)
        self.fake_names = self._generate_fake_names()
        self.fake_phones = self._generate_fake_phones()
        self.fake_addresses = self._generate_fake_addresses()
        
        # ì„±ì”¨ ë°ì´í„°
        self.compound_surnames = COMPOUND_SURNAMES
        self.single_surnames = SINGLE_SURNAMES
        
        # ì œì™¸ ë‹¨ì–´ ë¦¬ìŠ¤íŠ¸
        self.name_exclude_words = NAME_EXCLUDE_WORDS
        
        # ê¸°ë³¸ ì‹¤ëª… ëª©ë¡ (í•„í„°ë§ë¨)
        self._load_basic_names()
    
    def _load_basic_names(self):
        """ê¸°ë³¸ ì‹¤ëª… ëª©ë¡ ë¡œë“œ (ì ì ˆí•œ í•„í„°ë§ ì ìš©)"""
        basic_names = {
            # ë‚¨ì ì´ë¦„ë“¤ (ì¼ë°˜ì ì´ê³  í™•ì‹¤í•œ ì´ë¦„ë“¤)
            'ë¯¼ì¤€', 'ì„œì¤€', 'ë„ìœ¤', 'ì˜ˆì¤€', 'ì‹œìš°', 'ì£¼ì›', 'í•˜ì¤€', 'ì§€í˜¸', 'ì§€í›„', 'ì¤€ìš°',
            'í˜„ìš°', 'ì¤€ì„œ', 'ë„í˜„', 'ì§€í›ˆ', 'ê±´ìš°', 'ìš°ì§„', 'ì„ ìš°', 'ë¯¼ì¬', 'í˜„ì¤€', 'ìœ ì¤€',
            'ì„œì§„', 'ì—°ìš°', 'ì€ìš°', 'ì •ìš°', 'ì‹œìœ¤', 'ì¤€í˜', 'ìŠ¹í˜„', 'ì´ì¤€', 'ìŠ¹ìš°', 'ìŠ¹ë¯¼',
            'ì§€í™˜', 'ë¯¼ì„±', 'ìœ¤ìš°', 'ì¤€ì˜', 'ìˆ˜í˜¸', 'ìˆ˜í˜„', 'ë™í˜„', 'ì§„ìš°', 'ìœ ì°¬',
            'ì‹œí›„', 'ì§€ì›', 'ì´ì•ˆ', 'ì„±ë¯¼', 'ì§€ì•ˆ', 'ë¯¼ê·œ', 'ì¬ì›', 'ì¬ìœ¤', 'ì„±í˜„', 'ì‹œí˜„',
            'ì¤€í˜¸', 'ì§€í•œ', 'íƒœìœ¤', 'ë¡œìš´', 'ì¬ë¯¼', 'ë¯¼ìš°', 'ì¬í˜„', 'íƒœí˜„', 'ì •ë¯¼', 'ë¯¼ì°¬',
            'ì‹œì›', 'í•œê²°', 'ìœ¤í˜¸', 'ì‹œì˜¨', 'ìš°ì£¼', 'ë¯¼ì„', 'ì„œìš°', 'ì€ì°¬', 'ì„±ì¤€', 'ìŠ¹ì¤€',
            'ìš°ë¹ˆ', 'ì§€ë¯¼', 'ì •í˜„', 'ë„í•˜', 'ì´ë“ ', 'í˜„ì„œ', 'í˜„ìˆ˜', 'ë¯¼ìˆ˜', 'ë¯¼í˜¸', 'ìœ¤ì„±',
            
            # ì—¬ì ì´ë¦„ë“¤ (ì¼ë°˜ì ì´ê³  í™•ì‹¤í•œ ì´ë¦„ë“¤)
            'ì„œìœ¤', 'ì§€ìš°', 'ì„œí˜„', 'í•˜ì€', 'ì˜ˆì€', 'ìœ¤ì„œ', 'ì§€ë¯¼', 'ì±„ì›', 'í•˜ìœ¤', 'ì§€ìœ ',
            'ìˆ˜ì•„', 'ì˜ˆë¦°', 'ì˜ˆì›', 'ì‹œì€', 'ì†Œì€', 'ë‚˜ì€', 'ê°€ì€', 'ë‹¤ì€', 'í•˜ë¦°', 'ì±„ì€',
            'ìˆ˜ë¹ˆ', 'ìˆ˜ì—°', 'ì˜ˆë‚˜', 'ìœ ë‚˜', 'ë¯¼ì„œ', 'ì„œì—°', 'ì§€ì€', 'ì˜ˆì„œ', 'ì„œì˜', 'í•˜ì˜',
            'ì§€ì•ˆ', 'ìˆ˜ì§„', 'ì˜ˆì§€', 'ë‹¤ì¸', 'ìœ ì§„', 'ì†Œì—°', 'ì„œì€', 'ìœ ë¦¬', 'í•˜ëŠ˜', 'ê°€ì—°',
            'ì„œì§„', 'ë¯¼ì§€', 'ì˜ˆë¹ˆ', 'ì„œí•˜', 'ì§€ì•„', 'ê°€ì˜', 'ë‹¤ì—°', 'ìˆ˜ë¯¼', 'ì˜ˆì§„', 'í˜„ì„œ',
            'ë‹¤í˜„', 'ì„œì•ˆ', 'ì˜ˆë¦¼', 'ì±„ë¦°', 'ìˆ˜í˜„', 'ë¯¼ê²½', 'í•˜ìœ¨', 'ì˜ˆì†”', 'ì†Œìœ¨', 'í•˜ëŒ',
            
            # ì„±+ì´ë¦„ ì¡°í•© (í™•ì‹¤í•œ ê²ƒë“¤)
            'ê¹€ë¯¼ì¤€', 'ì´ì„œì¤€', 'ë°•ë„ìœ¤', 'ìµœì˜ˆì¤€', 'ì •ì‹œìš°', 'ê°•ì£¼ì›', 'ì¡°í•˜ì¤€', 'ìœ¤ì§€í˜¸',
            'ì¥ì§€í›„', 'ì„ì¤€ìš°', 'í•œí˜„ìš°', 'ì˜¤ì¤€ì„œ', 'ì„œë„í˜„', 'ì‹ ì§€í›ˆ', 'ê¶Œê±´ìš°', 'í™©ìš°ì§„',
            'ì•ˆì„ ìš°', 'ì†¡ë¯¼ì¬', 'ë¥˜í˜„ì¤€', 'ì „ìœ ì¤€', 'í™ì„œì§„', 'ê³ ì—°ìš°', 'ë¬¸ì€ìš°', 'ì–‘ì •ìš°',
            'ê¹€ì„œìœ¤', 'ì´ì§€ìš°', 'ë°•ì„œí˜„', 'ìµœí•˜ì€', 'ì •ì˜ˆì€', 'ê°•ìœ¤ì„œ', 'ì¡°ì§€ë¯¼', 'ìœ¤ì±„ì›',
            'ì¥í•˜ìœ¤', 'ì„ì§€ìœ ', 'í•œìˆ˜ì•„', 'ì˜¤ì˜ˆë¦°', 'ì„œì˜ˆì›', 'ì‹ ì‹œì€', 'ê¶Œì†Œì€', 'í™©ë‚˜ì€',
            'ì•ˆê°€ì€', 'ì†¡ë‹¤ì€', 'ë¥˜í•˜ë¦°', 'ì „ì±„ì€', 'í™ìˆ˜ë¹ˆ', 'ê³ ìˆ˜ì—°', 'ë¬¸ì˜ˆë‚˜', 'ì–‘ìœ ë‚˜',
            'ê¹€í™ê¸¸', 'ì´í™ê¸¸', 'ë°•í™ê¸¸', 'ìµœí™ê¸¸', 'ì •í™ê¸¸', 'ê°•í™ê¸¸', 'ì¡°í™ê¸¸', 'ìœ¤í™ê¸¸',
            'í™ê¸¸ë™', 'ê¹€ì² ìˆ˜', 'ì´ì˜í¬', 'ë°•ë¯¼ìˆ˜', 'ìµœìˆ˜ì˜', 'ì •ë¯¸ì˜', 'ê°•ì˜ìˆ˜', 'ì¡°ë¯¼í˜¸',
            
            # ì¶”ê°€ ì‹¤ëª…ë“¤ (name.csvì—ì„œ ìì£¼ ë‚˜ì˜¤ëŠ” ê²ƒë“¤)
            'í™ê¸¸', 'ê¹€ì² ', 'ì´ì˜', 'ë°•ë¯¼', 'ìµœìˆ˜', 'ì •ë¯¸', 'ê°•ì˜', 'ì¡°ë¯¼', 'ìœ¤ìˆ˜', 'ì¥ì˜',
            'ì„ë¯¼', 'í•œìˆ˜', 'ì˜¤ì˜', 'ì„œë¯¼', 'ì‹ ìˆ˜', 'ê¶Œì˜', 'í™©ë¯¼', 'ì•ˆìˆ˜', 'ì†¡ì˜', 'ë¥˜ë¯¼'
        }
        
        # ì œì™¸ ë‹¨ì–´ì— ìˆëŠ” ê²ƒë“¤ë§Œ ì œê±° (ë„ˆë¬´ ì—„ê²©í•˜ì§€ ì•Šê²Œ)
        filtered_names = set()
        for name in basic_names:
            if name not in self.name_exclude_words:
                filtered_names.add(name)
        
        self.real_names = filtered_names
        print(f"ê¸°ë³¸ ì‹¤ëª… ëª©ë¡ ë¡œë“œ: {len(filtered_names)}ê°œ (ì ì ˆí•œ í•„í„°ë§ í›„)")
    
    def _generate_fake_names(self) -> List[str]:
        """ê°€ëª… ì´ë¦„ ìƒì„± (ê¹€ê°€ëª…, ì´ê°€ëª… í˜•íƒœ)"""
        fake_names = []
        surnames = ['ê¹€', 'ì´', 'ë°•', 'ìµœ', 'ì •', 'ê°•', 'ì¡°', 'ìœ¤', 'ì¥', 'ì„', 'í•œ', 'ì˜¤', 'ì„œ', 'ì‹ ']
        fake_words = ['ê°€ëª…', 'ìµëª…', 'ë¬´ëª…', 'ë³„ëª…', 'ì°¨ëª…', 'ì„ëª…', 'ì„±ëª…', 'í˜¸ëª…', 'ì¹­ëª…', 'ì§€ëª…']
        
        for surname in surnames:
            for fake_word in fake_words:
                fake_names.append(surname + fake_word)
        
        return fake_names
    
    def _generate_fake_phones(self) -> List[str]:
        """ê°€ì§œ ì „í™”ë²ˆí˜¸ ìƒì„± (010-0000-0000ë¶€í„° 1ì”© ì¦ê°€)"""
        fake_phones = []
        for i in range(10000):  # 0000~9999
            fake_phones.append(f"010-{i:04d}-0000")
        return fake_phones
    
    def _generate_fake_addresses(self) -> List[str]:
        """ê°€ì§œ ì£¼ì†Œ ìƒì„± (ì‹œ/ë„ë§Œ)"""
        return ['ì„œìš¸ì‹œ', 'ë¶€ì‚°ì‹œ', 'ëŒ€êµ¬ì‹œ', 'ì¸ì²œì‹œ', 'ê´‘ì£¼ì‹œ', 'ëŒ€ì „ì‹œ', 'ìš¸ì‚°ì‹œ', 'ê²½ê¸°ë„', 'ê°•ì›ë„', 'ì¶©ë¶ë„']
    
    def _is_invalid_name(self, name: str) -> bool:
        """ì´ë¦„ìœ¼ë¡œ ë¶€ì ì ˆí•œ ë‹¨ì–´ì¸ì§€ í™•ì¸"""
        # ìˆ«ìê°€ í¬í•¨ëœ ê²½ìš°
        if any(char.isdigit() for char in name):
            return True
        
        # íŠ¹ìˆ˜ë¬¸ìê°€ í¬í•¨ëœ ê²½ìš°
        if not name.replace(' ', '').isalpha():
            return True
        
        # 1ê¸€ìì´ë©´ì„œ ì„±ì”¨ê°€ ì•„ë‹Œ ê²½ìš°
        if len(name) == 1 and name not in self.single_surnames:
            return True
        
        # ê°™ì€ ê¸€ì ë°˜ë³µ (ì˜ˆ: "ê°€ê°€", "ë‚˜ë‚˜ë‚˜")
        if len(name) >= 2 and len(set(name)) == 1:
            return True
        
        # ëª…ì‚¬ë¡œ ëë‚˜ëŠ” ê²½ìš°ë“¤
        noun_endings = ['ì‹œì¥', 'ì˜ì›', 'ì‚¬ì¥', 'ë¶€ì¥', 'ê³¼ì¥', 'íŒ€ì¥', 'íšŒì¥', 'ë³‘ì›', 'í•™êµ', 'íšŒì‚¬']
        for ending in noun_endings:
            if name.endswith(ending):
                return True
        
        return False
    
    def load_names_from_csv(self, csv_path: str):
        """CSVì—ì„œ ì´ë¦„ ë¡œë“œ (í•„í„°ë§ ì ìš©)"""
        if not os.path.exists(csv_path):
            print(f"CSV íŒŒì¼ ì—†ìŒ: {csv_path}")
            return
        
        try:
            loaded_names = set()
            with open(csv_path, 'r', encoding='utf-8') as f:
                reader = csv.DictReader(f)
                for row in reader:
                    name = row.get('ì´ë¦„', '').strip()
                    if name and len(name) >= 2:
                        # í•„í„°ë§ ì ìš©
                        if (name not in self.name_exclude_words and 
                            not self._is_invalid_name(name) and
                            len(name) <= 4):  # 4ê¸€ì ì´í•˜ë§Œ
                            loaded_names.add(name)
            
            # ê¸°ì¡´ ì´ë¦„ê³¼ í•©ì¹˜ê¸°
            self.real_names.update(loaded_names)
            print(f"CSVì—ì„œ {len(loaded_names)}ê°œ ì´ë¦„ ë¡œë“œ (í•„í„°ë§ í›„)")
            
        except Exception as e:
            print(f"CSV ë¡œë“œ ì‹¤íŒ¨ {csv_path}: {e}")
    
    def load_addresses_from_csv(self, csv_path: str):
        """CSVì—ì„œ ì£¼ì†Œ ë¡œë“œ"""
        if not os.path.exists(csv_path):
            print(f"ì£¼ì†Œ CSV íŒŒì¼ ì—†ìŒ: {csv_path}")
            return
        
        try:
            with open(csv_path, 'r', encoding='utf-8') as f:
                reader = csv.DictReader(f)
                for row in reader:
                    address = row.get('ì£¼ì†Œ', '').strip()
                    if address:
                        self.real_addresses.add(address)
            
            print(f"ì£¼ì†Œ CSVì—ì„œ {len(self.real_addresses)}ê°œ ì£¼ì†Œ ë¡œë“œ")
            
        except Exception as e:
            print(f"ì£¼ì†Œ CSV ë¡œë“œ ì‹¤íŒ¨ {csv_path}: {e}")
    
    def initialize(self, custom_data: Dict = None):
        """ë°ì´í„°í’€ ì´ˆê¸°í™”"""
        if self._initialized:
            return
        
        print("ğŸ“¦ ë°ì´í„°í’€ ì´ˆê¸°í™” ì¤‘...")
        
        # CSV íŒŒì¼ì—ì„œ ë°ì´í„° ë¡œë“œ
        self.load_names_from_csv('name.csv')
        self.load_addresses_from_csv('address_road.csv')
        
        # ì»¤ìŠ¤í…€ ë°ì´í„° ì¶”ê°€
        if custom_data:
            if 'names' in custom_data:
                filtered_custom_names = set()
                for name in custom_data['names']:
                    if (name not in self.name_exclude_words and 
                        not self._is_invalid_name(name)):
                        filtered_custom_names.add(name)
                self.real_names.update(filtered_custom_names)
                print(f"ì»¤ìŠ¤í…€ ì´ë¦„ {len(filtered_custom_names)}ê°œ ì¶”ê°€")
        
        self._initialized = True
        
        print(f"ğŸ“¦ ë°ì´í„°í’€ ì´ˆê¸°í™” ì™„ë£Œ:")
        print(f"  - ì‹¤ëª…: {len(self.real_names)}ê°œ")
        print(f"  - ì£¼ì†Œ: {len(self.real_addresses)}ê°œ")
        print(f"  - ì œì™¸ë‹¨ì–´: {len(self.name_exclude_words)}ê°œ")
        print(f"  - ì„±ì”¨: ë‹¨ì¼ {len(self.single_surnames)}ê°œ, ë³µí•© {len(self.compound_surnames)}ê°œ")

# ì „ì—­ ì¸ìŠ¤í„´ìŠ¤
_pools_instance = None

def get_pools() -> DataPools:
    """DataPools ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜"""
    global _pools_instance
    if _pools_instance is None:
        _pools_instance = DataPools()
    return _pools_instance

def initialize_pools(custom_data: Dict = None):
    """ë°ì´í„°í’€ ì´ˆê¸°í™”"""
    pools = get_pools()
    pools.initialize(custom_data)

def reload_pools():
    """ë°ì´í„°í’€ ì¬ë¡œë“œ"""
    global _pools_instance
    _pools_instance = None
    initialize_pools()